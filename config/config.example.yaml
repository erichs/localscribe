# localscribe configuration file
# Copy to ~/.localscribe.yaml or ~/.config/localscribe/config.yaml

# WebSocket server URL (default: ws://127.0.0.1:8080)
server_url: ws://127.0.0.1:8080

# API key for authentication (default: public_token)
api_key: public_token

# Output directory for transcript files (default: current directory)
output_dir: .

# Filename template with strftime-like placeholders (default: transcript_%Y%m%d_%H%M%S.txt)
# Supported: %Y (year), %m (month), %d (day), %H (hour), %M (minute), %S (second)
filename_template: transcript_%Y%m%d_%H%M%S.txt

# Audio gain multiplier (default: 1.0)
# Useful for boosting quiet microphones. Range: 0.1 - 10.0
gain: 1.0

# Audio input device index (default: -1 = default device)
# Use `localscribe -list-devices` to see available devices
device_index: -1

# Silence threshold in seconds for inserting line breaks (default: 2.0)
pause_threshold: 2.0

# Duration to wait before reconnecting when audio is active but no words generated.
# Works around ASR model bug with extended silence (see README for details).
# Set to 0 to disable. Default: 30s
dead_air_reset: 30s

# Enable debug output (default: false)
debug: false

# Metadata configuration
metadata:
  # Heartbeat timestamp interval in seconds (0 to disable)
  heartbeat_interval: 60

  # Enable Zoom meeting detection
  zoom_detection: false

  # Enable Google Meet detection
  meet_detection: false

  # Plugin configuration
  # Plugins are external scripts/executables that run at defined lifecycle events.
  # Each plugin's stdout is captured and written as metadata lines:
  #   %% plugin-name: <line>
  #
  # Environment variables passed to plugins:
  #   LOCALSCRIBE_EVENT         - on_start, on_meeting_start, on_meeting_end, periodic
  #   LOCALSCRIBE_OUTPUT_FILE   - path to current transcript file
  #   LOCALSCRIBE_TIMESTAMP     - current timestamp (RFC3339 format)
  #
  # Meeting events also include:
  #   LOCALSCRIBE_MEETING_TYPE  - zoom or meet
  #   LOCALSCRIBE_MEETING_CODE  - meeting code (e.g., "abc-defg-hij" for Meet)
  #   LOCALSCRIBE_MEETING_TITLE - meeting title (if available)
  #   LOCALSCRIBE_MEETING_DURATION - duration in seconds (on_meeting_end only)
  #
  # Plugins run in parallel and cannot depend on each other.
  # Errors are logged to stderr but don't stop transcription.
  # Use --debug to see plugin stdout/stderr in console.

  plugins:
    # Example: Git context at session start
    # - name: "git-context"
    #   command: "~/.config/localscribe/plugins/git-context.sh"
    #   trigger: on_start
    #   timeout: 5s

    # Example: Current git branch (inline command)
    # - name: "git-branch"
    #   command: "git rev-parse --abbrev-ref HEAD 2>/dev/null || echo 'not a git repo'"
    #   trigger: on_start

    # Example: Location from IP
    # - name: "location"
    #   command: "curl -s ipinfo.io/city"
    #   trigger: on_start
    #   timeout: 3s

    # Example: Pomodoro timer (runs every 25 minutes)
    # - name: "pomodoro"
    #   command: "echo 'Take a break!'"
    #   trigger: periodic
    #   interval: 1500

    # Example: Log meeting start to external service
    # - name: "meeting-logger"
    #   command: "~/.config/localscribe/plugins/log-meeting.sh"
    #   trigger: on_meeting_start

    # Example: Create summary on meeting end
    # - name: "meeting-summary"
    #   command: "~/.config/localscribe/plugins/summarize.sh"
    #   trigger: on_meeting_end
    #   timeout: 30s
